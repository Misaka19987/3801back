"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var l=n[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(n,t,l){return t&&e(n.prototype,t),l&&e(n,l),n}}();!function(e){"function"==typeof define&&define.amd?define(["zepto"],e):e(window.Zepto||window.jQuery)}(function($,undefined){$.indexedList=function(e){return new indexedList(e)};var indexedList=function(){function indexedList(e){_classCallCheck(this,indexedList),this.init(e)}return _createClass(indexedList,[{key:"init",value:function(e){this.config=$.extend(!0,{},{el:".indexed-list",elNav:".indexed-nav",datas:[]},e),this.autoCreate()}},{key:"autoCreate",value:function autoCreate(){var _self=this,datas=_self.config.datas,dataLen=datas&&datas.length;if(!dataLen)return void alert("抱歉，请传入您想要展示的数据哦~");var handleScroll=function(){var e=document.documentElement.scrollTop||document.body.scrollTop,n=_self.getArrIndex(topArr,e);$(_self.config.elNav).find("li").removeClass("active").eq(n).addClass("active")},labelsTpl="\n                    <% for(let i=0; i < dataLen; i++) { %>\n                        <li class=\"<%= i == 0 ? 'active' : '' %>\"><%= datas[i].label %></li>\n                    <% } %>\n                ",listTpl="\n                    <% for(let i=0; i < dataLen; i++) { %>\n                        <li>\n                            <h2><%= datas[i].label %></h2>\n                            <dl>\n                                <% for(let j=0; j < datas[i].lists.length; j++) { %>\n                                <dd><a><%= datas[i].lists[j] %></a></dd>\n                                <% } %>\n                            </dl>\n                        </li>\n                    <% } %>\n                ",topArr=[],_ref=[eval(_self.compile(labelsTpl)),eval(_self.compile(listTpl))],parseLabels=_ref[0],parseLists=_ref[1];$(_self.config.el).html(parseLists()).find("li").each(function(e,n){topArr.push(_self.getTop(e))}),$(_self.config.elNav).html(parseLabels()).on("click","li",function(){$(this).addClass("active").siblings().removeClass("active");var e=[$(this).text(),$(this).index()],n=e[0],t=e[1],l=_self.getTop(t);$("#hhb_prompt").length||($("body").append('<span id="hhb_prompt">'+n+"</span>"),$("html, body").scrollTo({toT:l,callback:function(){$("#hhb_prompt").remove()}}))});var throttled=_self.throttle(handleScroll,300);$(window).on("scroll",throttled)}},{key:"throttle",value:function(e,n){var t="",l="",a="",i="",o=0,r=function(){o=new Date,a=null,i=e.apply(t,l)};return function(){var s=new Date,c=n-(s-o);return t=this,l=arguments,c<=0?(clearTimeout(a),a=null,o=s,i=e.apply(t,l)):a||(a=setTimeout(r,c)),i}}},{key:"getTop",value:function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return $(this.config.el).find("li").eq(e).offset().top}},{key:"getArrIndex",value:function(e,n){var t=[];return e.map(function(e){t.push(Math.abs(e-n))}),t.indexOf(Math.min.apply(null,t))}},{key:"compile",value:function(e){var n=/<%=(.+?)%>/g,t=/<%([\s\S]+?)%>/g;return e=e.replace(n,"`); \n  echo( $1 ); \n  echo(`").replace(t,"`); \n $1 \n  echo(`"),'(function parse(data){\n              let output = "";\n          \n              function echo(html){\n                output += html;\n              }\n          \n              '+(e="echo(`"+e+"`);")+"\n          \n              return output;\n            })"}}]),indexedList}();$.fn.scrollTo=function(e){var n={toT:0,durTime:400,delay:30,callback:null},t=$.extend(n,e),l=this,a=l.scrollTop(),i=null,o=t.toT-a,r=0,s=Math.round(t.durTime/t.delay),c=function(e){r++;var n=Math.round(o/s);if(r>=s)return l.scrollTop(e),clearInterval(i),void(t.callback&&"function"==typeof t.callback&&t.callback());l.scrollTop(a+r*n)};return i=setInterval(function(){c(t.toT)},t.delay),l}});